apply plugin: 'java'
apply plugin: 'rup-java'

buildscript {
    repositories {
        maven {url rupRepoExtUrl}
        ivy {url rupRepoReleaseUrl }
        if (project.hasProperty('developPlugins')) {
            ivy {url file(System.getProperty('user.home') + '/.ivylocal')}
        }
    }
    dependencies {
        classpath("com.copyright.rup.scm:gradle-plugins:${rupGradlePluginsVersion}")
    }
}

dependencies {
	compile ("org.springframework:spring-webmvc:${rupJava.standardDependencies.spring.version}")

	compile ("com.copyright.rup.common:rup-common-util:${rupGradlePluginsVersion}")
	
	compile ("com.thoughtworks.xstream:xstream:1.4.+")
	// Not using jackson 2.0 because of lack of spring support
	compile ("org.codehaus.jackson:jackson-mapper-asl:1.9.+")
	compile ("org.springframework:spring-oxm:${rupJava.standardDependencies.spring.version}")

    compile ("org.springframework:spring-web:${rupJava.standardDependencies.spring.version}")
    compile ("org.springframework:spring-webmvc:${rupJava.standardDependencies.spring.version}")

    //TODO: cannot use providedCompile without war plugin
    compile ("javax.servlet:javax.servlet-api:3.0.1")

    //compile ("org.powermock:powermock-api-easymock:1.4.9")

    compile ("org.springframework:spring-test:${rupJava.standardDependencies.spring.version}")
    compile ("junit:junit-dep:${rupJava.standardDependencies.junit.version}")

    compile ("commons-lang:commons-lang:2.4")
}

task loadProperties {
	File props = new File('../../config.properties')
	def userProps = new Properties() 
	props.withReader { reader -> 
	  userProps.load(reader) 
	  rootProject.getAdditionalProperties().putAll(userProps)
	}
}

/*
task loadWebProperties(type: Copy) {
	println '--------------------------------------------------------------------------------------------------------'
	def sep = System.properties['file.separator'];
	println "${project.projectDir}${sep}src${sep}main${sep}resources"
	println "${rootProject.buildDir}${sep}resources${sep}main"
	println '--------------------------------------------------------------------------------------------------------'
	from "${project.projectDir}${sep}src${sep}main${sep}resources"
	into "${rootProject.buildDir}${sep}resources${sep}main"
}
*/

processResources.dependsOn loadProperties

/*
[processResources,build].each{ task ->
	task.dependsOn loadProperties
}
*/
